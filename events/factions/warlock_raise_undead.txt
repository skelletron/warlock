namespace = warlock_raise_undead

# warlock_raise_undead.0001 = {
# 	type = character_event
# 	theme = war
# 	title = warlock_raise_undead.0001.t
# 	desc = warlock_raise_undead.0001.desc

# 	left_portrait = {
# 		character = scope:undead_leader
# 		animation = personality_bold
# 	}

# 	trigger = {}

# 	immediate = {
# 		hidden_effect = {
# 			create_character = {
# 				name = "UNDEAD LEADER"
# 				# location = random_county = {
# 				# 	limit = {}
# 				# }

# 				# which of these is correct?
# 				# location = scope:actor.primary_title.title_province
# 				location = scope:actor.capital_province

# 				template = undead_leader_template
# 				save_scope_as = undead_leader
# 				# See if both of these work
# 				# scope:actor
# 				# scope:target
# 			}
# 			scope:undead_leader = {
# 				create_dynamic_title = {
# 					tier = duchy
# 					name = "Realm of the Dead"
# 				}
# 				create_title_and_vassal_change = {
# 					type = created
# 					save_scope_as = change
# 					add_claim_on_loss = no
# 				}
# 				scope:new_title = {
# 					set_capital_county = scope:actor.capital_province.county
# 					set_landless_title = yes
# 					set_destroy_on_succession = yes
# 					set_delete_on_destroy = yes
# 					set_no_automatic_claims = yes
# 					set_definitive_form = yes
# 					set_can_be_named_after_dynasty = no

# 					change_title_holder = {
# 						holder = scope:undead_leader
# 						change = scope:change
# 					}
# 				}
# 				resolve_title_and_vassal_change = scope:change
# 				add_prestige = 10000
# 				add_gold = 10000

# 				add_opinion = {
# 					modifier = angry_opinion
# 					target = scope:actor
# 					opinion = -50
# 				}
# 			}
# 			scope:undead_leader = {
# 				start_war = {
# 					casus_belli = undead_war
# 					target = scope:actor.primary_title
# 				}
# 			}
# 			scope:undead_leader = {
# 				spawn_army = {
# 					uses_supply = no
# 					inheritable = no
# 					name = sterlization_army_02_event_troops
# 					levies = {
# 						value = 100000
# 					}
# 					men_at_arms = {
# 						type = bombard
# 						stacks = 1
# 					}
# 					men_at_arms = {
# 						type = house_guard
# 						stacks = 1
# 					}	
# 				}
# 				location = scope:actor.capital_province
# 			}
# 		}
# 	}
# 	# option = {
# 	# 	scope:undead_leader = {
# 	# 		start_war = {
# 	# 			casus_belli = undead_war
# 	# 			target = scope:actor.primary_title
# 	# 		}
# 	# 	}
# 	# 	scope:undead_leader = {
# 	# 		spawn_army = {
# 	# 			uses_supply = no
# 	# 			inheritable = no
# 	# 			name = sterlization_army_02_event_troops
# 	# 			levies = {
# 	# 				value = 100000
# 	# 			}
# 	# 			men_at_arms = {
# 	# 				type = bombard
# 	# 				stacks = 1
# 	# 			}
# 	# 			men_at_arms = {
# 	# 				type = house_guard
# 	# 				stacks = 1
# 	# 			}	
# 	# 		}
# 	# 		location = scope:actor.capital_province
# 	# 	}
# 	# }
# 	after = {
# 		set_global_variable = {
# 			name = undead_war_is_over
# 			value = yes
# 		}
# 		custom_tooltip = warlock_raise_undead.0001.after.tt
# 	}
# }


warlock_raise_undead.0001 = {
	type = character_event
	theme = war
	title = warlock_raise_undead.0001.t
	desc = warlock_raise_undead.0001.desc

	left_portrait = {
		character = scope:undead_leader
		animation = personality_bold
	}

	trigger = {}

	immediate = {
		hidden_effect = {
			create_character = {
				name = "UNDEAD LEADER"
				# location = random_county = {
				# 	limit = {}
				# }

				# which of these is correct?
				# location = scope:recipient.primary_title.title_province
				location = scope:recipient.capital_province
				# location = title:c_upland.title_province

				template = undead_leader_template
				save_scope_as = undead_leader
				# See if both of these work
				# scope:recipient
				# scope:target
			}
			scope:undead_leader = {
				create_dynamic_title = {
					tier = duchy
					name = "UNDEAD DUCHY"
				}
				create_title_and_vassal_change = {
					type = created
					save_scope_as = change
					add_claim_on_loss = no
				}
				scope:new_title = {
					# set_capital_county = scope:recipient.capital_province.county
					# set_capital_county = title:c_upland
					set_capital_county = scope:recipient.capital_province.county
					set_landless_title = yes
					set_destroy_on_succession = yes
					set_delete_on_destroy = yes
					set_no_automatic_claims = yes
					set_definitive_form = yes
					set_can_be_named_after_dynasty = no

					change_title_holder = {
						holder = scope:undead_leader
						change = scope:change
					}
				}
				resolve_title_and_vassal_change = scope:change
				add_prestige = 10000
				add_gold = 10000

				add_opinion = {
					modifier = angry_opinion
					target = scope:recipient
					# target = title:k_sweden.holder
					opinion = -50
				}
			}
		}
	}
	option = {
		scope:undead_leader = {
			start_war = {
				casus_belli = undead_war
				# target = scope:recipient.primary_title
				target = scope:recipient
				# target = title:k_sweden.holder
			}
		}
		scope:undead_leader = {
			spawn_army = {
				uses_supply = no
				inheritable = no
				name = sterlization_army_02_event_troops
				levies = {
					value = 100000
				}
				men_at_arms = {
					type = bombard
					stacks = 1
				}
				men_at_arms = {
					type = house_guard
					stacks = 1
				}	
				# location = title:c_upland.title_province
				location = scope:recipient.capital_province
			}
		}
	}
	after = {
		set_global_variable = {
			name = undead_war_is_over
			value = yes
		}
		custom_tooltip = warlock_raise_undead.0001.after.tt
	}
}

# warlock_raise_undead.0001 = {
# 	type = character_event
# 	theme = war
# 	title = warlock_raise_undead.0001.t
# 	desc = warlock_raise_undead.0001.desc

# 	left_portrait = {
# 		character = scope:undead_leader
# 		animation = personality_bold
# 	}

# 	trigger = {}

# 	immediate = {
# 		hidden_effect = {
# 			create_character = {
# 				name = "UNDEAD LEADER"
# 				# location = random_county = {
# 				# 	limit = {}
# 				# }

# 				# which of these is correct?
# 				# location = scope:actor.primary_title.title_province
# 				location = scope:actor.capital_province

# 				template = undead_leader_template
# 				save_scope_as = undead_leader
# 				# See if both of these work
# 				# scope:actor
# 				# scope:target
# 			}
# 			scope:undead_leader = {
# 				create_dynamic_title = {
# 					tier = duchy
# 					name = "Realm of the Dead"
# 				}
# 				create_title_and_vassal_change = {
# 					type = created
# 					save_scope_as = change
# 					add_claim_on_loss = no
# 				}
# 				scope:new_title = {
# 					set_capital_county = scope:actor.capital_province.county
# 					set_landless_title = yes
# 					set_destroy_on_succession = yes
# 					set_delete_on_destroy = yes
# 					set_no_automatic_claims = yes
# 					set_definitive_form = yes
# 					set_can_be_named_after_dynasty = no

# 					change_title_holder = {
# 						holder = scope:undead_leader
# 						change = scope:change
# 					}
# 				}
# 				resolve_title_and_vassal_change = scope:change
# 				add_prestige = 10000
# 				add_gold = 10000

# 				add_opinion = {
# 					modifier = angry_opinion
# 					target = scope:actor
# 					opinion = -50
# 				}
# 			}
# 		}
# 	}
# 	option = {
# 		scope:undead_leader = {
# 			start_war = {
# 				casus_belli = undead_war
# 				target = scope:actor.primary_title
# 			}
# 		}
# 		scope:undead_leader = {
# 			spawn_army = {
# 				uses_supply = no
# 				inheritable = no
# 				name = sterlization_army_02_event_troops
# 				levies = {
# 					value = 100000
# 				}
# 				men_at_arms = {
# 					type = bombard
# 					stacks = 1
# 				}
# 				men_at_arms = {
# 					type = house_guard
# 					stacks = 1
# 				}	
# 			}
# 			location = scope:actor.capital_province
# 		}
# 	}
# 	after = {
# 		set_global_variable = {
# 			name = undead_war_is_over
# 			value = yes
# 		}
# 		custom_tooltip = warlock_raise_undead.0001.after.tt
# 	}
# }


# errors
# [06:49:26][jomini_effect.cpp:557]: Unknown effect resolve_title_and_vassal_change at  file: events/factions/warlock_raise_undead.txt line: 161
# [06:49:26][jomini_effect.cpp:557]: Unknown effect scope:undead_leader at  file: events/factions/warlock_raise_undead.txt line: 180

# warlock_raise_undead.0001 = {
# 	type = character_event
# 	theme = war
# 	title = warlock_raise_undead.0001.t # Synthetic Dawn III
# 	desc = warlock_raise_undead.0001.desc
# 	# title = PDXCON.1400.t # Synthetic Dawn III
# 	# desc = PDXCON.1400.desc
# 	# type = character_event
# 	# type = letter_event
# 	# sender = scope:peasant_leader
# 	# opening = "FACTION_DEMAND_UNDEAD"
# 	# desc = FACTION_DEMAND_UNDEAD_DESC

# 	left_portrait = {
# 		character = scope:undead_leader
# 		animation = personality_bold
# 		#war_attacker
# 	}

# 	trigger = {
# 		# exists = scope:faction
# 		# exists = scope:peasant_leader
# 		# scope:peasant_leader.joined_faction = scope:faction
# 	}
# 	immediate = {
# 		debug_log = "inside immediate block"
# 		hidden_effect = {
# 			create_character = {
# 				name = "UNDEAD LEADER"
# 				location = scope:actor.capital_province
# 				template = undead_leader_template
# 				save_scope_as = undead_leader
# 			}


					
# 			scope:undead_leader = {

# 				create_dynamic_title = {
# 					tier = duchy
# 					# name = FACTION_PEASANT_TITLE_NAME
# 					name = "UNDEAD DUCHY"
# 				}
# 				create_title_and_vassal_change = {
# 					type = created
# 					save_scope_as = change
# 					add_claim_on_loss = no
# 				}

# 				scope:new_title = {
# 					# set_capital_county = scope:peasant_county
# 					set_capital_county = title:c_upland
# 					set_landless_title = yes
# 					set_destroy_on_succession = yes
# 					set_delete_on_destroy = yes
# 					set_no_automatic_claims = yes
# 					set_definitive_form = yes
# 					set_can_be_named_after_dynasty = no
# 					change_title_holder = {
# 						holder = scope:undead_leader
# 						change = scope:change
# 					}
# 				}
# 				resolve_title_and_vassal_change = scope:change

# 				add_prestige = 10000
# 				add_gold = 10000

# 			}
# 		}
# 	}

# 	option = {

# 		scope:undead_leader = {
		
# 			# To start a war:		
# 			start_war = {
# 				casus_belli = undead_war
# 				target = scope:actor.primary_title
# 			}
# 		}

# 		scope:undead_leader = {
# 			spawn_army = {
# 				# uses_supply = yes
# 				uses_supply = no
# 				inheritable = no
# 				name = sterlization_army_02_event_troops
# 				levies = {
# 					value = 100000
# 				}
# 				men_at_arms = {
# 					type = bombard
# 					stacks = 1
# 				}
# 				men_at_arms = {
# 					type = house_guard
# 					stacks = 1
# 				}				

# 				location = scope:actor.capital_province
# 			}				
# 		}
# 	}

# 	after = {	
# 		set_global_variable = {
# 			name = undead_war_is_over
# 			value = yes
# 		}
# 		# custom_tooltip = PDXCON.1400.after.tt
# 		custom_tooltip = warlock_raise_undead.0001.after.tt
# 		# debug_log = warlock_raise_undead.0001.after.tt
# 		debug_log = "Undead War is Over dubuuuu"
# 	}
# }
